# 匿名反馈系统命令测试指南

## 用户反馈命令
- `/匿名反馈 发送 [内容] [图片1-5] [文件1-3]` - 发送匿名反馈（支持文字+多图片+多文件）
- `/匿名反馈 查询溯源记录 [时间范围] [反馈编号]` - 查询管理员溯源记录
- `/匿名反馈 删除反馈 [反馈编号]` - 删除自己的反馈（24小时内）

## 帖主管理命令
- `/匿名反馈-帖主 减少警告 [用户] [次数]` - 帖主减少用户警告
- `/匿名反馈-帖主 全局封禁用户 [用户] [原因]` - 帖主全局封禁用户
- `/匿名反馈-帖主 解除全局封禁 [用户]` - 帖主解除全局封禁
- `/匿名反馈-帖主 禁用匿名功能 [原因]` - 帖主禁用匿名功能
- `/匿名反馈-帖主 启用匿名功能` - 帖主启用匿名功能
- `/匿名反馈-帖主 删除反馈并警告 [反馈编号] [原因]` - 帖主删除反馈并警告

## 管理员命令
- `/匿名反馈管理 封禁 [用户] [原因]` - 管理员封禁功能
- `/匿名反馈管理 查询反馈 [反馈编号]` - 查询反馈详情（含溯源）
- `/匿名反馈管理 删除反馈 [反馈编号] [原因]` - 删除反馈
- `/匿名反馈管理 用户统计 [用户]` - 查看用户统计

## 功能特性
1. **统一发送命令**：支持文字+最多5张图片+最多3个文件
2. **图片直接显示**：图片作为文件附件直接显示，无需点击链接
3. **智能回退机制**：下载失败时自动回退到链接方式
4. **按帖主警告系统**：每个帖主独立计算警告次数
5. **6个踩自动删除**：降低删除阈值，提高响应速度
6. **帖主全局管理**：支持全局封禁和禁用匿名功能
7. **用户自主删除**：24小时内可删除自己的反馈
8. **溯源记录查询**：用户可查询管理员溯源记录
9. **24小时内单帖20次反馈限制**
10. **详细的日志记录系统**

## 技术改进
1. **多文件处理**：使用aiohttp异步下载，io.BytesIO内存处理
2. **Discord时间戳**：使用`<t:timestamp:R>`格式显示时间
3. **数据库优化**：9个核心表，完整索引支持
4. **命令结构统一**：`/匿名反馈`、`/匿名反馈-帖主`、`/匿名反馈管理`
5. **错误处理增强**：完善的异常处理和用户提示

## 日志记录
所有操作都会记录到日志中，包含"匿名反馈系统"前缀：
- 匿名反馈发送记录（含附件数量）
- 管理员溯源操作记录
- 帖主和管理员管理操作记录
- 用户警告和封禁记录
- 图片下载和处理记录 